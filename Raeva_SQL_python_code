import pandas as pd
import sqlite3

con = sqlite3.connect('D:/sql_amazon_canada/database', timeout=10)
cur = con.cursor()

#подключаем файл БД
df = pd.read_csv('D:/sql_amazon_canada/amz_ca_total_products_data_processed.csv', sep=',')
df.to_sql(con=con, name='research_data', index=False, if_exists='append')

#проверяем, подключилась ли таблица к базе данных
#data_test = cur.execute('select * from research_data')
#con.commit()
#result = cur.fetchall()
#print(result)

#проверяем на наличие дубликатов и пустых строк
duplicates = df.duplicated()
df_no_duplicates = df.drop_duplicates()
df_no_empty_rows = df.dropna()
